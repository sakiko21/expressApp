<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>会員マイページ</title>
    <Link rel="stylesheet" href ="../style.css">
</head>
<body>
    <h2 class="page-title">マイページ</h2>
</body>
<script>
// ページのロード時に実行する処理
window.onload = function() {
    // トークンをクッキーから取得する
    const token = document.cookie.replace(/(?:(?:^|.*;\s*)user_token\s*\=\s*([^;]*).*$)|^.*$/, "$1");
    console.log(document.cookie);

    if (!token || token === ""){
        //トークンがない場合、ログインページへリダイレクト.マイページの検証のため一旦コメントアウト
        console.log(token);
        // window.location.href = "/user/login";
    }else{
        // トークンを使ってアカウントページへのリクエストを行う
        console.log(token);
        fetch("/user/account", {
            method: "GET",
            headers: {
                "Authorization": `Bearer ${token}`
            }
        })
        .then((res) => res.json())
        .then((data) => {
            // レスポンスデータを使って何か処理を行う
        })
        .catch((err) => {
            // エラーハンドリング
        });
        window.location.href = "/user/account.html";
    }
};
</script>
</html>